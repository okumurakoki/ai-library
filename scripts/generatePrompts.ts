import { createClient } from '@supabase/supabase-js';
import { v4 as uuidv4 } from 'uuid';
import * as dotenv from 'dotenv';

dotenv.config();

const supabaseUrl = process.env.VITE_SUPABASE_URL || '';
const supabaseAnonKey = process.env.VITE_SUPABASE_ANON_KEY || '';
const supabase = createClient(supabaseUrl, supabaseAnonKey);

// カテゴリごとのプロンプトテンプレート
const categories = {
  business: {
    name: 'ビジネス',
    templates: [
      { title: '営業メール作成', content: '以下の製品/サービスについて、顧客に送る営業メールを作成してください。\n\n製品/サービス: [製品名]\nターゲット: [ターゲット層]\n特徴: [主な特徴]', usage: '新規営業や既存顧客へのアプローチに活用', example: '製品名: クラウド会計ソフト\nターゲット: 中小企業の経理担当者\n特徴: 自動仕訳、リアルタイム集計' },
      { title: 'ビジネス提案書作成', content: 'クライアントへの提案書を作成してください。\n\n提案内容: [提案内容]\n課題: [クライアントの課題]\n解決策: [提案する解決策]', usage: '新規案件の提案や改善提案に使用', example: '提案内容: Webサイトリニューアル\n課題: 古いデザイン、低いCV率\n解決策: モダンなUI/UX設計' },
      { title: '会議議事録作成', content: '以下の会議内容から議事録を作成してください。\n\n日時: [日時]\n参加者: [参加者]\n議題: [議題]\n決定事項: [決定事項]\nアクションアイテム: [TODO]', usage: '会議後の記録整理に活用', example: '日時: 2024/1/15 14:00\n参加者: 営業部5名\n議題: Q1売上目標設定' },
      { title: '業務マニュアル作成', content: '以下の業務についてマニュアルを作成してください。\n\n業務名: [業務名]\n目的: [業務の目的]\n手順: [手順の概要]', usage: '新人教育や業務標準化に使用', example: '業務名: 請求書発行\n目的: 正確な請求処理\n手順: 1.受注確認 2.金額計算 3.発行' },
      { title: 'SWOT分析レポート', content: '以下の企業/プロジェクトについてSWOT分析を行ってください。\n\n対象: [対象]\n強み: [強み]\n弱み: [弱み]\n機会: [機会]\n脅威: [脅威]', usage: '事業戦略立案や市場分析に活用', example: '対象: 新規EC事業\n強み: 豊富な商品ライン\n弱み: 認知度が低い' },
    ]
  },
  realestate: {
    name: '不動産',
    templates: [
      { title: '物件紹介文作成', content: '以下の物件情報から魅力的な紹介文を作成してください。\n\n物件種別: [マンション/戸建て/土地]\n所在地: [住所]\n価格: [価格]\n特徴: [主な特徴]', usage: '物件広告や紹介資料に使用', example: '種別: 分譲マンション\n所在地: 東京都港区\n価格: 5980万円\n特徴: 駅徒歩3分、南向き' },
      { title: '賃貸契約書チェックリスト', content: '賃貸契約を結ぶ前に確認すべき項目のチェックリストを作成してください。\n\n物件タイプ: [アパート/マンション/戸建て]\n重視する点: [重視する点]', usage: '契約前の確認漏れ防止に活用', example: '物件タイプ: ワンルームマンション\n重視点: 初期費用、設備' },
      { title: '内見時の質問リスト', content: '物件内見時にオーナーや管理会社に聞くべき質問リストを作成してください。\n\n物件種別: [種別]\n懸念事項: [懸念事項]', usage: '内見時の確認漏れ防止', example: '種別: 築20年マンション\n懸念: 修繕履歴、騒音' },
      { title: '不動産投資分析レポート', content: '以下の投資用物件について収益分析を行ってください。\n\n物件価格: [価格]\n想定家賃: [家賃]\n経費: [年間経費]\nローン条件: [ローン条件]', usage: '投資判断の材料として活用', example: '価格: 3000万円\n家賃: 月10万円\n経費: 年50万円' },
      { title: '住宅ローン返済計画', content: '以下の条件で住宅ローンの返済計画を作成してください。\n\n借入額: [金額]\n金利: [金利]\n返済期間: [年数]\n返済方式: [元利均等/元金均等]', usage: '住宅購入時の資金計画に使用', example: '借入額: 4000万円\n金利: 1.5%\n期間: 35年' },
    ]
  },
  construction: {
    name: '建築',
    templates: [
      { title: '建築見積書作成', content: '以下の建築工事について見積書を作成してください。\n\n工事内容: [工事内容]\n建物種別: [建物種別]\n規模: [規模]\n工期: [工期]', usage: '顧客への見積提示に使用', example: '内容: 住宅新築\n種別: 木造2階建て\n規模: 延床120㎡\n工期: 6ヶ月' },
      { title: '工事工程表作成', content: '以下の建築工事の工程表を作成してください。\n\n工事名: [工事名]\n着工日: [着工日]\n完成予定: [完成予定]\n主要工程: [主要工程]', usage: '工事スケジュール管理に活用', example: '工事名: 店舗改装\n着工: 2024/2/1\n完成: 2024/4/30' },
      { title: '建築図面の説明文', content: '以下の建築図面について、顧客向けの説明文を作成してください。\n\n図面種類: [平面図/立面図/断面図]\n特徴: [設計の特徴]\n注目ポイント: [注目ポイント]', usage: '顧客へのプレゼンテーションに使用', example: '種類: 1階平面図\n特徴: オープンLDK\n注目: 動線の工夫' },
      { title: '建築確認申請書類チェックリスト', content: '建築確認申請に必要な書類のチェックリストを作成してください。\n\n建物用途: [用途]\n構造: [構造]\n規模: [規模]', usage: '申請準備の漏れ防止に活用', example: '用途: 専用住宅\n構造: 木造\n規模: 2階建て' },
      { title: 'リフォーム提案書', content: '以下の条件でリフォーム提案書を作成してください。\n\n対象箇所: [対象箇所]\n現状の問題: [問題点]\n提案内容: [提案内容]\n予算: [予算]', usage: '顧客へのリフォーム提案に使用', example: '対象: キッチン\n問題: 老朽化、使いにくい\n提案: システムキッチン交換' },
    ]
  },
  accounting: {
    name: '経理',
    templates: [
      { title: '月次決算報告書作成', content: '以下のデータから月次決算報告書を作成してください。\n\n対象月: [対象月]\n売上高: [売上高]\n経費: [経費]\n営業利益: [営業利益]', usage: '経営陣への報告に使用', example: '対象月: 2024年1月\n売上: 500万円\n経費: 350万円\n利益: 150万円' },
      { title: '経費精算依頼書', content: '以下の経費について精算依頼書を作成してください。\n\n日付: [日付]\n項目: [経費項目]\n金額: [金額]\n用途: [使用目的]', usage: '社員の経費精算手続きに使用', example: '日付: 2024/1/20\n項目: 交通費\n金額: 5,800円\n用途: 顧客訪問' },
      { title: '予算管理レポート', content: '以下の予算実績データから管理レポートを作成してください。\n\n部門: [部門]\n予算: [予算額]\n実績: [実績額]\n差異: [差異]', usage: '予算管理会議の資料作成に活用', example: '部門: 営業部\n予算: 月200万円\n実績: 180万円\n差異: -20万円' },
      { title: '請求書発行文面', content: '以下の内容で請求書に添付する文面を作成してください。\n\n取引先: [取引先名]\n請求内容: [請求内容]\n金額: [金額]\n支払期限: [期限]', usage: '請求書送付時に使用', example: '取引先: ○○株式会社\n内容: Webサイト制作\n金額: 50万円\n期限: 2024/2/28' },
      { title: '資金繰り表作成', content: '以下のデータから資金繰り表を作成してください。\n\n対象期間: [期間]\n期首残高: [残高]\n入金予定: [入金]\n出金予定: [出金]', usage: '資金管理に活用', example: '期間: 2024年2月\n期首: 300万円\n入金: 500万円\n出金: 450万円' },
    ]
  },
  communication: {
    name: 'コミュニケーション',
    templates: [
      { title: 'お礼メール作成', content: '以下の状況でお礼のメールを作成してください。\n\n相手: [相手]\n状況: [お礼する状況]\n関係性: [関係性]', usage: 'ビジネスやプライベートでのお礼に使用', example: '相手: 取引先担当者\n状況: 契約締結\n関係性: 3年来の取引' },
      { title: '謝罪文作成', content: '以下の状況で謝罪文を作成してください。\n\n相手: [相手]\n問題内容: [問題内容]\n今後の対応: [対応策]', usage: 'トラブル発生時の謝罪に使用', example: '相手: 顧客\n問題: 納期遅延\n対応: 優先対応で挽回' },
      { title: '社内報告メール', content: '以下の内容を社内に報告するメールを作成してください。\n\n報告内容: [報告内容]\n重要度: [重要度]\n対応依頼: [依頼事項]', usage: '社内での情報共有に使用', example: '内容: システム障害\n重要度: 緊急\n依頼: 復旧作業協力' },
      { title: '自己紹介文作成', content: '以下の情報で自己紹介文を作成してください。\n\n名前: [名前]\n職業/役職: [職業]\n経歴: [経歴]\n趣味/特技: [趣味]', usage: 'SNSやビジネスシーンでの自己紹介に使用', example: '名前: 山田太郎\n職業: Webデザイナー\n経歴: 5年\n趣味: 写真撮影' },
      { title: '面談依頼メール', content: '以下の目的で面談を依頼するメールを作成してください。\n\n相手: [相手]\n目的: [面談の目的]\n希望日時: [候補日時]', usage: '商談や打ち合わせの設定に使用', example: '相手: 新規顧客\n目的: サービス説明\n日時: 来週中' },
    ]
  },
  research: {
    name: 'リサーチ',
    templates: [
      { title: '市場調査レポート', content: '以下の市場について調査レポートを作成してください。\n\n調査対象: [市場/業界]\n調査項目: [調査項目]\n分析視点: [分析視点]', usage: '事業計画や戦略立案に活用', example: '対象: クラウド会計市場\n項目: 市場規模、成長率\n視点: 競合分析' },
      { title: '競合分析フレームワーク', content: '以下の競合について分析してください。\n\n競合企業: [企業名]\n比較項目: [比較項目]\n自社との違い: [差異]', usage: '競争戦略の策定に使用', example: '企業: A社\n項目: 価格、機能、サポート\n違い: 価格は高いが機能豊富' },
      { title: '顧客アンケート設計', content: '以下の目的でアンケートを設計してください。\n\n調査目的: [目的]\nターゲット: [対象者]\n知りたい情報: [調査項目]', usage: '顧客満足度調査やニーズ調査に使用', example: '目的: サービス改善\n対象: 既存顧客\n項目: 満足度、要望' },
      { title: 'トレンド分析レポート', content: '以下のトレンドについて分析レポートを作成してください。\n\nトレンド: [トレンド]\n影響範囲: [影響範囲]\nビジネス機会: [機会]', usage: '新規事業検討や商品開発に活用', example: 'トレンド: AI活用\n範囲: 全業界\n機会: 業務効率化サービス' },
      { title: 'ユーザーインタビュー質問設計', content: '以下の目的でユーザーインタビューの質問を設計してください。\n\n目的: [調査目的]\n対象者: [インタビュー対象]\n仮説: [検証したい仮説]', usage: 'UXリサーチやプロダクト開発に使用', example: '目的: 新機能検証\n対象: ヘビーユーザー\n仮説: ○○機能が役立つ' },
    ]
  },
  creative: {
    name: 'クリエイティブ',
    templates: [
      { title: 'キャッチコピー作成', content: '以下の商品/サービスのキャッチコピーを作成してください。\n\n商品名: [商品名]\nターゲット: [ターゲット]\n特徴: [主な特徴]\nトーン: [トーン]', usage: '広告やLP制作に使用', example: '商品: オーガニック化粧品\nターゲット: 30代女性\n特徴: 無添加、保湿力\nトーン: やさしい' },
      { title: 'SNS投稿文作成', content: '以下の内容でSNS投稿文を作成してください。\n\nプラットフォーム: [Twitter/Instagram/Facebook]\n内容: [投稿内容]\n目的: [投稿目的]', usage: 'SNSマーケティングに活用', example: 'プラットフォーム: Instagram\n内容: 新商品告知\n目的: 認知拡大' },
      { title: 'ブログ記事構成案', content: '以下のテーマでブログ記事の構成案を作成してください。\n\nテーマ: [テーマ]\nターゲット: [読者]\n目的: [記事の目的]\n文字数: [文字数]', usage: 'コンテンツマーケティングに使用', example: 'テーマ: SEO対策入門\n読者: 初心者\n目的: 基礎知識提供\n文字数: 3000字' },
      { title: '動画企画書作成', content: '以下の動画企画書を作成してください。\n\n動画タイトル: [タイトル]\nターゲット: [視聴者]\n内容: [動画内容]\n長さ: [動画の長さ]', usage: 'YouTube等の動画コンテンツ制作に使用', example: 'タイトル: 時短料理レシピ\n視聴者: 忙しい主婦\n内容: 10分で作れる夕食\n長さ: 5分' },
      { title: 'プレスリリース作成', content: '以下の情報でプレスリリースを作成してください。\n\n発表内容: [内容]\n発表日: [日付]\n企業情報: [企業情報]\n問い合わせ先: [連絡先]', usage: '新商品発表やイベント告知に使用', example: '内容: 新サービス開始\n日付: 2024/2/1\n企業: ○○株式会社' },
    ]
  },
  planning: {
    name: '企画',
    templates: [
      { title: 'イベント企画書作成', content: '以下のイベント企画書を作成してください。\n\nイベント名: [イベント名]\n目的: [目的]\nターゲット: [参加者]\n内容: [プログラム]\n予算: [予算]', usage: '社内外イベントの企画に使用', example: 'イベント: 新商品発表会\n目的: 認知拡大\n参加者: 200名\n予算: 500万円' },
      { title: '新商品企画書', content: '以下の新商品企画書を作成してください。\n\n商品名: [商品名]\nコンセプト: [コンセプト]\nターゲット: [ターゲット]\n差別化ポイント: [差別化]', usage: '新商品開発の提案に使用', example: '商品: スマート家電\nコンセプト: IoT連携\nターゲット: 共働き世帯' },
      { title: 'キャンペーン企画書', content: '以下のキャンペーン企画書を作成してください。\n\nキャンペーン名: [名称]\n目的: [目的]\n期間: [期間]\n施策: [実施内容]\nKPI: [目標指標]', usage: '販促キャンペーンの企画に使用', example: '名称: 春の感謝祭\n目的: 売上20%増\n期間: 3/1-3/31\nKPI: 売上、新規顧客数' },
      { title: 'プロジェクト計画書', content: '以下のプロジェクト計画書を作成してください。\n\nプロジェクト名: [名称]\n目的: [目的]\nスコープ: [範囲]\nスケジュール: [スケジュール]\n体制: [体制]', usage: 'プロジェクト立ち上げ時に使用', example: '名称: 基幹システム刷新\n目的: 業務効率化\n期間: 6ヶ月' },
      { title: 'ワークショップ設計', content: '以下のワークショップを設計してください。\n\nテーマ: [テーマ]\n参加者: [参加者]\n時間: [所要時間]\nゴール: [達成目標]\nプログラム: [内容]', usage: '研修や勉強会の企画に使用', example: 'テーマ: アイデア発想法\n参加者: 社員20名\n時間: 3時間\nゴール: 新規企画案創出' },
    ]
  },
};

async function generatePrompts() {
  console.log('プロンプト生成を開始します...');

  let totalCount = 0;

  for (const [categoryKey, categoryData] of Object.entries(categories)) {
    console.log(`\n${categoryData.name}カテゴリのプロンプトを生成中...`);

    const templates = categoryData.templates;
    const promptsToGenerate = 100;
    const promptsPerTemplate = Math.ceil(promptsToGenerate / templates.length);

    for (const template of templates) {
      for (let i = 0; i < promptsPerTemplate; i++) {
        const prompt = {
          id: uuidv4(),
          title: `${template.title} ${i + 1}`,
          content: template.content,
          category: categoryKey,
          use_case: [],
          tags: [categoryData.name, template.title.split(' ')[0]],
          usage: template.usage,
          example: template.example,
          is_premium: false,
          plan_type: 'standard',
        };

        const { error } = await supabase
          .from('prompts')
          .insert(prompt);

        if (error) {
          console.error(`エラー: ${prompt.title}`, error);
        } else {
          totalCount++;
          if (totalCount % 50 === 0) {
            console.log(`${totalCount}件のプロンプトを登録しました...`);
          }
        }
      }
    }
  }

  console.log(`\n完了！合計${totalCount}件のプロンプトを生成しました。`);
}

generatePrompts();
